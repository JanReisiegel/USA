# 7. Teorie odhadu

## 7.2 BodovÃ© odhady

- MÄ›jme nÃ¡hodnÃ½ vÃ½bÄ›r z urÄitÃ©ho rozdÄ›lenÃ­, kterÃ© zÃ¡visÃ­ na parametru Î˜. Odhadem T parametru Î˜ je pak vÃ½bÄ›rovÃ¡ charakteristika, kterÃ¡ nabÃ½vÃ¡ hodnot "blÃ­zkÃ½c" k neznÃ¡mÃ©mu parametru Î˜
- Parametr Î˜ mÅ¯Å¾e bÃ½t: rozptyl, Äetnost, mediÃ¡n, stÅ™ednÃ­ hodnota, atd.
- BodovÃ½ odhad musÃ­ splÅˆovat:
  - Nestrannost
    - je-li E(T) = Î˜,
    - je-li lim(E(T<sub>n</sub>) - Î˜)=0;nâ†’âˆ => asymptoticky nestrannÃ½
  - Konzistentnost
    - je-li lim(P(|Î˜ - T<sub>n</sub>| < Îµ)) = 1; nâ†’âˆ
    - Je-li konzistentnÃ­, pak je malÃ¡ pravdÄ›podobnost, Å¾e se pÅ™i zvyÅ¡ujÃ­cÃ­m se rozsahu vÃ½beru dopustÃ­me velkÃ© chyby
  - Vydatnost
    - TakovÃ¡ statistika, kterÃ¡ mÃ¡ ze vÅ¡ech nestrannÃ½ch odhadÅ¯ nejmenÅ¡Ã­ rozptyl
    - limD(T<sub>n</sub>) = 0; nâ†’âˆ
  - Robustnost
    - takovÃ¡ statistika, kterÃ¡ nenÃ­ vÃ½raznÄ› ovlivnitelnÃ¡ hodnotami zpÅ¯sobenÃ© napÅ™Ã­klad hrubou chybou
    - nenÃ­ minimum a maximum
    - je aritmetickÃ½ prÅ¯mÄ›r

## 7.3 IntervalovÃ© odhady

- Interval spolehlivosti (konfidenÄnÃ­ interval) pro parametr Î˜ je takovÃ¡ dvojice statistik, pro kterou s pravdÄ›podobnostÃ­ 1-ğ›¼ (ğ›¼âˆˆ<0,1>) platÃ­:

![IntervalovÃ½ odhad](pictures/interval_odhad_1.png)

- Spolehlivost odhadu 1-ğ›¼ poÅ¾adujeme blÃ­zkou 1
  - obvykle 0.05, vzÃ¡cnÄ›ji 0.01 nebo 0.001
  - Se sniÅ¾ujÃ­cÃ­m se ğ›¼ se rozÅ¡iÅ™uje interval
- Pro zÃºÅ¾enÃ­ intervalu je tÅ™eba mÃ­t vÃ­ce namÄ›Å™enÃ½ch hodnot
  - Pro dvojnÃ¡sobnÃ© zÃºÅ¾enÃ­ je tÅ™eba 4Ã— vÃ­ce dat
- OboustrannÃ½ interval spolehlivosti:
  - hledÃ¡me interval ve kterÃ©m danÃ½ parametr leÅ¾Ã­ se spolehlivostÃ­ 1-ğ›¼
  - VÃ½sledek udÃ¡vÃ¡ obÄ› meze

![OboustrannÃ½ intervalovÃ½ odhad](pictures/interval_odhad_both.png)

- JednostrannÃ© intervaly spolehlivosti
  - "LEFT"
    - udÃ¡vÃ¡ pouze hornÃ­ mez
    - ğ‘ƒ(Î˜â‰¤ğ‘‡<sub>â„</sub>) = 1âˆ’ğ›¼ interval (âˆ’âˆ,ğ‘‡<sub>ğ»</sub>),
  - "Right"
    - udÃ¡vÃ¡ pouze dolnÃ­ mez
    - ğ‘ƒ(Î˜â‰¥ğ‘‡<sub>ğ‘‘</sub> = 1âˆ’ğ›¼ interval (ğ‘‡<sub>ğ·</sub>,âˆ)

## 7.4 IntervalovÃ½ odhad stÅ™ednÃ­ hodnoty normÃ¡lnÃ­ho rozdÄ›lenÃ­

- dva pÅ™Ã­pady
  - smÄ›rodatnÃ¡ odchylka je pÅ™edem znÃ¡mÃ¡
  - smÄ›rodatnÃ¡ odchylka je neznÃ¡mÃ¡
- NutnÃ½ pÅ™edpoklad: Data pochÃ¡zejÃ­ z normÃ¡lnÃ­ho rozdÄ›lenÃ­

### 7.4.1 ğœ je pÅ™edem znÃ¡mÃ¡

- NÃ¡hodnÃ¡ veliÄina je z normÃ¡lnÃ­ho rozdÄ›lenÃ­ s neznÃ¡mou stÅ™ednÃ­ hodnotou a pÅ™edem definovanou smÄ›rodatnou odchylkou. Vybereme vzorek z populace o rozmÄ›ru n, kterÃ½ mÃ¡ vÃ½bÄ›rovÃ½ prÅ¯mÄ›r

![VÃ½poÄet intervalovÃ©ho odhadu](pictures/str_hod_zname.png)

- MATLAB: - **[h,p,ci]=ztest(x,m,sigma,alpha,tail)**
  - h - vÃ½sledek hypotÃ©zy
  - p - p-value
  - ci - konfidenÄnÃ­ interval
  - x - vektor vstupnÃ­ch dat
  - m - stÅ™ednÃ­ hodnota se kterou je prÅ¯mÄ›r porovnÃ¡vÃ¡n
  - sigma - smÄ›rodatnÃ¡ odchylka
  - aplha - hladina vÃ½znamnosti testu
  - tail - typ intervalovÃ©ho odhadu

![Tail u ztestu](pictures/z-test_tail.png)

### 7.4.3 ğœ je neznÃ¡mÃ¡

- nÃ¡hodnÃ¡ veliÄina s neznÃ¡mou stÅ™ednÃ­ hodnotou a nedefinovanou smÄ›rodatnou odchylkou
- Vybereme vzorek z populace o rozsahu n, kterÃ½ mÃ¡ vÃ½bÄ›rovÃ½ prÅ¯mÄ›r a vÃ½bÄ›rovou smÄ›rodatnou odchylku
- VÃ½poÄet:

![VÃ½poÄet intervalovÃ©ho odhadu](pictures/str_hod_nezname.png)

- MATLAB: **[h,p,ci,stats]=ttest(x,m,alpha,tail)**
  - h - vÃ½sledek hypotÃ©zy
  - p - p-value
  - ci - konfidenÄnÃ­ interval
  - stats - vÃ½sledek T statistiky, poÄet stupÅˆÅ¯ volnosti a smÄ›rodatnÃ¡ odchylka
  - x - vektor vstupnÃ­ch dat
  - m - stÅ™ednÃ­ hodnota se kterou je prÅ¯mÄ›r porovnÃ¡vÃ¡n
  - sigma - smÄ›rodatnÃ¡ odchylka (1-alpha)
  - aplha - hladina vÃ½znamnosti testu
  - tail - typ intervalovÃ©ho odhadu
    - 'both' - oboustrannÃ½
    - 'left' - jednostrannÃ½ - - (âˆ’âˆ,ğ‘‡<sub>ğ»</sub>)
    - 'right' - jednostrannÃ½ - (ğ‘‡<sub>ğ·</sub>,âˆ)

## 7.5 IntervalovÃ½ odhad rozptylu normÃ¡lnÃ­ho rozdÄ›lenÃ­

- NÃ¡hodnÃ¡ veliÄina z normÃ¡lnÃ­ho rozdÄ›lenÃ­ s neznÃ¡mou stÅ™ednÃ­ hodnotou a neznÃ¡mÃ½m rozptylem
- Vybereme vzorek z populace o rozsahu n, kterÃ½ mÃ¡ vÃ½bÄ›rovÃ½ rozptyl

![VÃ½poÄet intervalovÃ©ho odhadu rozptylu](pictures/rozptyl_norm_rozd.png)

- MATLAB: **[h,p,ci,stat]=vartest(x,v,alpha,tail)**

![Parametry vartest](pictures/vartest_all.png)

## 7.6 IntervalovÃ½ odhad smÄ›rodatnÃ© odchylky normÃ¡lnÃ­ho rozdÄ›lenÃ­

- nÃ¡hodnÃ¡ veliÄina z normÃ¡lnÃ­ho rozdÄ›lenÃ­ s neznÃ¡mou stÅ™ednÃ­ hodnotou a neznÃ¡mÃ½m rozptylem
- Vybereme vzorek z populace o rozsahu n, kterÃ½ mÃ¡ vÃ½bÄ›rovou smÄ›rodatnou odchylku s

![InervalovÃ½ odhad smÄ›rodatnÃ© odchylky](pictures/odchylka_vzorec.png)

## 7.7 IntervalovÃ½ odhad relativnÃ­ Äetnosti

- vÃ½bÄ›rovÃ½ soubor o rozsahu n. NechÅ¥ x prvkÅ¯ ze souboru mÃ¡ urÄitou vlastnost; pravdÄ›podobnost tÃ©to vlastnosti je p=x/n.
- DÃ¡le nechÅ¥ je rozsah souboru:
  - DostateÄnÄ› velkÃ½ (n > 30)
  - menÅ¡Ã­ neÅ¾ 5% rozsahu zÃ¡kladnÃ­ho souboru (n/N < 0.05)
  - SplÅˆujÃ­cÃ­ podmÃ­nku: n > 9/(p(1-p))

![IntervalovÃ½ odhad lrelativnÃ­ Äetnosti](pictures/rel_cetnost_vzorce.png)

- NenÃ­ v MATLAB implementovÃ¡n
  - oboustrannÃ½: Ci=[p-sqrt(p*(1-p)/n)*norminv(1-alfa/2,0,1),p+sqrt(p*(1-p)/n)*norminv(1-alfa/2,0,1)]
  - jednostrannÃ½: Ci=[0, p+sqrt(p*(1-p)/n)*norminv(1-alfa,0,1)]
  - jednostrannÃ½: Ci=[p-sqrt(p*(1-p)/n)*norminv(1-alfa,0,1), 1]

## 7.8 Odhad rozsahu vÃ½bÄ›ru

- chceme znÃ¡t rozsah vÃ½bÄ›ru, jestliÅ¾e intervalovÃ½ odhad mÃ¡ mÃ­t urÄitou Å¡Ã­Å™ku
- Velikost Å¡Ã­Å™ky Î” intervalovÃ©ho odhadu je zÃ¡vislÃ¡ na velikosti vstupu n
- OdvodÃ­me:
  - OdeÄtenÃ­m mezÃ­ oboustrannÃ©ho odhadu a vyjÃ¡dÅ™enÃ­m n
  - Vzorec pro intervalovÃ½ odhad stÅ™ednÃ­ hodnoty
- Î” je obÄas definovÃ¡na jako polovina z maximÃ¡lnÃ­ Å¡Ã­Å™ky intervalu
- OdvozenÃ­:

![OdvozenÃ­ velikosti Å¡Ã­Å™ky](pictures/odvozeni_sirky.png)

- VÃ½poÄet:

![VÃ½poÄet odhadu relativnÃ­ Äetnosti](pictures/vypocet_odhadu_rel_cetnosti.png)

## 7.9 IntervalovÃ½ odhad mediÃ¡nu

- JestliÅ¾e data nepochÃ¡zÃ­ z normÃ¡lnÃ­ho rozdÄ›lenÃ­, nelze stanovit intervalovÃ½ odhad stÅ™ednÃ­ hodnoty
- VyuÅ¾Ã­vÃ¡ se napÅ™Ã­klad intervalovÃ½ odhad mediÃ¡nu s vyuÅ¾itÃ­m interkvartilovÃ©ho rozpÄ›tÃ­
- IntervalovÃ½ odhad se spolehlivostÃ­ 95% se stanovÃ­ pomocÃ­ vzorce:

![VÃ½poÄet IntervalovÃ©ho odhadu mediÃ¡nu](pictures/inter_odhad_median.png)

- V MATLABU nenÃ­ implementovÃ¡no:
  - (median(x)-1.57*iqr(x)/sqrt(n), median(x)+1.57*iqr(x)/sqrt(n))

## 7.10 IntervalovÃ½ odhad parametrÅ¯ spojitÃ½ch rozdÄ›lenÃ­

- IntervalovÃ½ odhad lze zjistit i pro nÃ¡hodnou veliÄin, kterÃ¡ nenÃ­ z normÃ¡lnÃ­ho rozdÄ›lenÃ­
- V MATLAB:
  - DiskrÃ©tnÃ­
    - BinomickÃ© rozdÄ›lenÃ­ - **[par,io]=binofit(x,n,aplha)**
    - Poissonovo rozdÄ›lenÃ­ - **[par,io]=poissfit(x,aplha)**
  - SpojitÃ©
    - NormÃ¡lnÃ­ rozdÄ›lenÃ­ - **[par,io]=normfit(x,aplha,cens,freq)**
    - LognormÃ¡lnÃ­ rozdÄ›lenÃ­ - **[par,io]=lognfit(x,aplha,cens,freq)**
    - ExponenciÃ¡lnÃ­ rozdÄ›lenÃ­ - **[par,io]=expfit(x,aplha,cens,freq)**
    - Weibullovo rozdÄ›lenÃ­ - **[par,io]=wblfit(x,aplha,cens,freq)**
    - Gamma rozdÄ›lenÃ­ - **[par,io]=gamfit(x,aplha,cens,freq)**
  - par - odhad hodnoty parametrÅ¯
  - io - konfidenÄnÃ­ interval parametrÅ¯ uvedenÃ½ po sloupcÃ­ch
  - x - vstupnÃ­ vektor
  - alpha - hladina vÃ¡znamnosti (1-alpha)
  - cens - zkouÅ¡ka ukonÄena, 0 chybou, 1 Äasem
  - freq - poÄet vÃ½skytÅ¯

## 7.11 IntervalovÃ½ odhad distribuÄnÃ­ funkce

- graf empirickÃ© distribuÄnÃ­ funkce
  - MATLAB: **cdfplot**
- TextovÃ© vÃ½stupy zajistÃ­ **ecdf**
- **[f,x,flo,fup] = ecdf(x,'alphaâ€™,â€™censoringâ€™,â€™frequencyâ€™)**
  - f - hodnoty skokÅ¯ distribuÄnÃ­ funkce F(x)
  - x - hodnoty zmÄ›n na x-ovÃ© ose
  - flo - dolnÃ­ mez intervalovÃ©ho odhadu distribuÄnÃ­ funkce
  - fup - hornÃ­ mez intervalovÃ©ho odhadu distribuÄnÃ­ funkce
  - alpha - hlavina vÃ½znamnosti
  - censoring - typ ukonÄenÃ­ zkouÅ¡ky (0 porucha, 1 Äas)
  - frequency - Äetnost vÃ½sledku

## 7.12 IntervalovÃ½ odhad pomÄ›ru rozptylÅ¯ dvou vÃ½bÄ›rÅ¯ s normÃ¡lnÃ­m rozdÄ›lenÃ­m

- MÄ›jme 2 vÃ½bÄ›ry z normÃ¡lnÃ­ho rozdÄ›lenÃ­
- Vybereme vzorek s populace o rozsahu n<sub>1</sub> a n<sub>2</sub>, kterÃ½ mÃ¡ vÃ½bÄ›rovÃ½ rozptyl s<sub>1</sub><sup>2</sup> a s<sub>2</sub><sup>2</sup>
- VÃ½poÄet intervalovÃ©ho odhadu podÃ­lu rozptylÅ¯ s<sub>1</sub><sup>2</sup>/s<sub>2</sub><sup>2</sup>:

![IntervalovÃ½ odhad podÃ­lu rozptylÅ¯](pictures/podil_rozdilu.png)

- MATLAB:
  - **[h,p,ci]=vartest2(x,y,alpha,tail)**

![Parametry funkce vartest2](pictures/vartest2_all.png)

## 7.13 IntervalovÃ½ odhad rozdÃ­lu stÅ™ednÃ­ch hodnot dvou vÃ½bÄ›rÅ¯ s normÃ¡lnÃ­m rozdÄ›lenÃ­m

- VÃ½poÄtu musÃ­ pÅ™edchÃ¡ze test shody rozptylÅ¯ dvou vÃ½bÄ›rÅ¯ kapitola 8.4.1 (nebo 7.11)
- ZnÃ¡me rozptyly (jsou pÅ™edem definovanÃ©)
  - NenÃ­ v MATLAB implementovÃ¡n

![Odhad rozdÃ­lu stÅ™ednÃ­ch hodnot - znÃ¡me rozptyly](pictures/odhad_rozd_str_hod_2.png)

- NeznÃ¡me rozptyly obou populacÃ­, ale lze pÅ™edpoklÃ¡dat, Å¾e jsou shodnÃ©
  - Shodnost rozptylu dvou vÃ½bÄ›rÅ¯ lze ovÄ›Å™it statistickÃ½m testem, kterÃ½ obvykle pÅ™edchÃ¡zÃ­ vÃ½poÄtu intervalovÃ©ho odhadu

![Odhad rozdÃ­lu sztÅ™ednmÃ­ch hodnot - neznÃ¡me rozptyly, jsou stejnÃ©](pictures/odhad_rozdilu_strhod_3.png)

- NeznÃ¡me rozptyly obou populacÃ­ a lze pÅ™edpoklÃ¡dat, Å¾e nejsou shodnÃ©
  - (Ne)shodnost rozptylu dvou vÃ½bÄ›rÅ¯ lze ovÄ›Å™it statistickÃ½m testem, kterÃ½ obvykle pÅ™edchÃ¡zÃ­ vÃ½poÄtu intervalovÃ©ho odhadu.

![Odhad rozdÃ­lu stÅ™ednÃ­ch hodnot - neznÃ¡me rozptyly, nejsou shodnÃ©](pictures/odhad_rozdilu_str_hod_4.png)

- MATLAB: **[h,p,ci]=ttest2(x,y,alpha,tail,vartype)**

![Parametry funkce ttest2](pictures/ttest2-all.png)

## 7.14 IntervalovÃ½ odhad pro rozdÃ­l relativnÃ­ch ÄetnostÃ­ dvou populacÃ­

- MÄ›jme 2 populace, z nichÅ¾ byly provedeny dva nezÃ¡vislÃ© nÃ¡hodnÃ© vÃ½bÄ›ry o rozsahu n<sub>1</sub> a n<sub>2</sub>, kde poÄet prvkÅ¯ s urÄitou vlastnostÃ­ je x<sub>1</sub> a c<sub>2</sub>.
- Potom pravdÄ›podobnost vÃ½skytu urÄitÃ© vlastnosti je p<sub>1</sub> = x<sub>1</sub>/n<sub>1</sub> a p<sub>2</sub> = x<sub>2</sub>/n<sub>2</sub>
- NnechÅ¥ dÃ¡le platÃ­ o rozsahu vÃ½bÄ›ru:
  - VÃ½bÄ›ry jsou dostateÄnÄ› velkÃ© => n<sub>1</sub> > 30, n<sub>2</sub> > 30
  - MÃ¡me mÃ©nÄ› neÅ¾ 5% rozsahu zÃ¡kladnÃ­ho souboru => n<sub>1</sub>/N<sub>1</sub> < 0.05, n<sub>2</sub>/N<sub>2</sub> < 0.05
  - SplÅˆuje podmÃ­nky: n<sub>1</sub> > 9/(p<sub>1</sub>(1 - p<sub>1</sub>)) a n<sub>2</sub> > 9/(p<sub>2</sub>(1 - p<sub>2</sub>))
- NechÅ¥ dÃ¡le platÃ­ :
  - p = (x<sub>1</sub> + x<sub>2</sub>)/(n<sub>1</sub> + n<sub>2</sub>)
- Potom intervalovÃ½ odhad:

![IntervalovÃ½ odhad pro rozdÃ­l relativnÃ­ch ÄetnostÃ­ 2 populacÃ­](pictures/int_odhad_rel_cetnosti_2.png)

- NenÃ­ implementovÃ¡m v MATLAB, proto vzorce:
  - vstup:
    - n1,n2,x1,x2,alfa
    - p1 = x1/n1
    - p2 = x2/n2
    - p = (x1+x2)/(n1+n2)
  - OboustrannÃ½ intervalovÃ½ odhad
    - Ci=[(p1-p2)-sqrt(p*(1-p)*(1/n1+1/n2))*norminv((1-alfa/2),0,1),(p1-p2)+sqrt(p*(1-p)*(1/n1+1/n2))*norminv((1-alfa/2),0,1)]
  - JednostrannÃ½ <-âˆ,Ci>
    - Ci=((p1-p2)+sqrt(p*(1-p)*(1/n1+1/n2))\*norminv((1-alfa),0,1))
  - JednostrannÃ½ <Ci,âˆ>
    - Ci=((p1-p2)-sqrt(p*(1-p)*(1/n1+1/n2))\*norminv((1-alfa/2),0,1))
