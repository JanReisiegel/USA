# 11 RegresnÃ­ analÃ½za

- regrese umoÅ¾Åˆuje odhadovat hodnotu jistÃ© spojitÃ© nÃ¡hodnÃ© veliÄiny na zÃ¡kladÄ› znalosti jinÃ½ch nezÃ¡vislÃ½ch veliÄin
- RegresnÃ­ analÃ½za hledÃ¡ funkÄnÃ­ zÃ¡vislost mezi vysvÄ›tlujÃ­cÃ­ a vysvÄ›tlovanou

## 11.1 LeneÃ¡rnÃ­ regrese

### 11.1.1 Ãšvod do lineÃ¡rnÃ­ regrese

- NamÄ›Å™enÃ© hodnoty y jsou zatÃ­Å¾eny chybou, snaha o proloÅ¾enÃ­ urÄitou funkÄnÃ­ zÃ¡vislostÃ­, kterÃ¡ by minimalizovala souÄet kvadrÃ¡tÅ¯ chyby
- NÄ›kdy nazÃ½vanÃ¡ metoda nejmenÅ¡Ã­ch ÄtvercÅ¯
- Vstupem
  - n - poÄet namÄ›Å™enÃ½ch dat
  - [x<sub>i</sub>,y<sub>i</sub>] - namÄ›Å™enÃ© hodnoty
- LineÃ¡rnÃ­ regrese = Y = ax + b
  - a,b, - regresnÃ­ koeficienty
  - x - nezÃ¡vislÃ¡ promÄ›nnÃ¡, vysvÄ›tlujÃ­cÃ­ promÄ›nnÃ¡, regresor
  - y - zÃ¡vislÃ¡ promÄ›nnÃ¡, vysvÄ›tlovanÃ¡ promÄ›nnÃ¡, regresand

### 11.1.2 LineÃ¡rnÃ­ regrese

- LineÃ¡rnÃ­ rtegresnÃ­ model
  - MatematickÃ¡ analÃ½za: y = ax + b
  - Statistika: y<sub>i</sub> + ax<sub>i</sub> + b + ğœ€<sub>i</sub>
  - ğœ€<sub>i</sub> je nÃ¡hodnÃ¡ sloÅ¾ka i-tÃ©ho mÄ›Å™enÃ­
- HledÃ¡me a a b tak, abychom minimalizovali sumu kvadrÃ¡tÅ¯ nÃ¡hodnÃ½ch sloÅ¾ek

![Metoda nejmenÅ¡Ã­ch ÄtvercÅ¯](pictures/lin_regrese.png)

- PÅ™edpoklady:
  - nÃ¡hodnÃ© chyby majÃ­ normÃ¡lnÃ­ rozdÄ›lenÃ­
  - stÅ™ednÃ­ hodnota je nulovÃ¡
  - rozptyl nÃ¡hodnÃ© sloÅ¾hy je konstantnÃ­
  - navrÅ¾enÃ½ modle nesmÃ­ bÃ½t lineÃ¡rnÄ› zÃ¡vislÃ½

![LineÃ¡rnÃ­ regrese - vzorce](pictures/lin_regrese_vzorce.png)

- MATLAB: **NLM=fitlm(x,y,modelfun,dalÅ¡Ã­ parametry)**

![Parametry fitlm](pictures/film_all.png)

## 11.2 Verifikace modelu

![Verifikace Modelu](pictures/Verifikace_modelu.png)

### 11.2.1 Ftest

- ovÄ›Å™uje se sprÃ¡vnost pouÅ¾itÃ©ho modelu
  - H0: vÅ¡echny parametry = 0 (kromÄ› konstantnÃ­ho parametru)
  - HA: nÄ›kterÃ½ z parametrÅ¯ != 0
  - obvykle se zamÃ­tÃ¡, protoÅ¾e p-value je velmi malÃ¡
- splÅˆuje Fisher-Snedecorovo rozdÄ›lenÃ­ s (k,n-(k+1)) stupni volnosti
- pvalue = 1 - F<sub>0</sub>(x<sub>obs</sub>)

### 11.2.2 IntervalovÃ½ odhad regresivnÃ­ch koeficientÅ¯

- coefCI(LM,alpha)

![vÃ½poÄet intervalovÃ©ho odhadu](pictures/intrvalovy_odhad_koeficientu.png)

### 11.2.3 Test hypotÃ©z o koeficientech regresnÃ­ funkce

- hypotÃ©zy:
  - H0: a=Î± ğ»A:aâ‰ Î±
  - ğ»0:ğ‘=ğ›½ ğ»A:ğ‘â‰ ğ›½
- TestovacÃ­ kritÃ©rium:
  - ğ‘‡=(ğ‘âˆ’ğ›¼)/ğ‘†<sub>ğ‘</sub> ğ‘‡=(ğ‘âˆ’ğ›½)/ğ‘†<sub>ğ‘</sub>

### 11.2.4 Koeficient determinace

- Pro urÄenÃ­ sÃ­ly zÃ¡vislosti se vychÃ¡zÃ­ z pomÄ›ru proloÅ¾enÃ½ch ku namÄ›Å™enÃ½m souÄtu ÄtvercÅ¯
- Koeficient determinace:

![VÃ½poÄet koeficientu determinace](pictures/koeficient_determinace.png)

- Koeficient nabÃ½vÃ¡ hodnot od 0 k 1:
  - r<sup>2</sup> = 1 - data jsou pÅ™esnÄ› proloÅ¾eny funkcÃ­
  - r<sup>2</sup> = 0 - proloÅ¾enÃ­ je zcela nevhodnÃ©, nelze vektor y proloÅ¾it pomocÃ­ x
  - Obvykle model je uznÃ¡n za vhodnÃ½, jestliÅ¾e r<sup>2</sup> > 0.8
- Koeficient determinace je kvadrÃ¡t korelaÄnÃ­ho koeficientu

## 11.3 NelineÃ¡rnÃ­ regrese

- Lze stanovit parametry uÅ¾ivatelem navrÅ¾enÃ©ho modelu
- rozÅ¡Ã­Å™enÃ­ polynomiÃ¡lnÃ­ho modelu o dalÅ¡Ã­ funkce
- VÃ½poÄet probÃ­hÃ¡ numericky - nutno stanovit vstupnÃ­ vektory pÅ™ibliÅ¾nÃ©ho Å™eÅ¡enÃ­
- mocnÃ½ numerickÃ½ nÃ¡stroj
- vlivem numerickÃ©ho vÃ½poÄtu je vÅ¡ak nutnÃ© mÃ­t u vÃ½sledkÅ¯ inÅ¾enÃ½rskÃ½ nÃ¡hled
- MATLAB: **NLM=fitnlm(x,y,modelfun,beta0,dalÅ¡Ã­ parametry)**

![Parametry finlm](pictures/film_all.png)

- Jak zjistit sprÃ¡vnost modelu:
  - Root Mean Square Error pokud velkÃ© v porovnÃ¡nÃ­ s jinÃ½m modelem tak Å¡patnÄ›
  - R-Squares pokud malÃ© v porovnÃ¡nÃ­ s jinÃ½m modelem tak Å¡patnÄ›
  - F-statistic - velkÃ¡ hodnota Å¡patnÄ› popsanÃ½ model
